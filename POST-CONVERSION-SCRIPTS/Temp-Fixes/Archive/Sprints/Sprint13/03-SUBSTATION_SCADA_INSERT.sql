SET ECHO ON
SET LINESIZE 1000
SET PAGESIZE 300
SET TRIMSPOOL ON
SPOOL SUBSTATION_SCADA_INSERT.LOG 

ALTER TABLE B$SCADA_N DISABLE ALL TRIGGERS;

INSERT
  INTO B$SCADA_N
    (
      G3E_ID
    ,G3E_FNO
    ,G3E_CNO
    ,G3E_FID
    ,G3E_CID
    ,LTT_ID
    ,LTT_STATUS
    ,LTT_DATE
    ,LTT_TID
    ,CAPABLE_YN
    ,DEVICE_ID
    ,DEVICE_FUNCTION
    ,ENABLED_YN
    )
SELECT   B$SCADA_N_PKG.GETSEQUENCEVALUE G3E_ID
  ,16 G3E_FNO
  ,33 G3E_CNO
  ,SB.G3E_FID G3E_FID
  ,1 G3E_CID
  ,0 LTT_ID
  ,NULL LTT_STATUS
  ,TO_DATE (SYSDATE,'YYYY-MM-DD HH24:MI:SS') LTT_DATE
  ,NULL LTT_TID
  ,'N' CAPABLE_YN
  ,DEVICE_ID_SEQ.NEXTVAL DEVICE_ID
  ,NULL DEVICE_FUNCTION
  ,'N' ENABLED_YN
  FROM B$SUB_BREAKER_N SB
  WHERE NOT EXISTS
    (SELECT   1
      FROM B$SCADA_N S
      WHERE S.G3E_FID = SB.G3E_FID
    ) ;
COMMIT;

ALTER TABLE B$SCADA_N ENABLE ALL TRIGGERS;

SPOOL OFF;