set echo on
set linesize 1000
set pagesize 300
set trimspool on

spool c:\temp\StyleRules_NetworkProtector.log
--**************************************************************************************
-- SCRIPT NAME: StyleRules_NetworkProtector.sql
--**************************************************************************************
-- AUTHOR			    : INGRNET\RRADASE
-- DATE				    : 10-MAR-2018
-- PRODUCT VERSION	: 10.3.0
-- PRJ IDENTIFIER	: G/TECHNOLOGY - ONCOR
-- PROGRAM DESC		: Styles and style rules for Network Protector
--**************************************************************************************
-- Modified:
--  17-JUL-2018, Rich Adase -- SME symbology review
--**************************************************************************************

alter trigger M_T_AUDR_G3E_STYLERULE_RULE disable;
alter trigger M_T_AUD_G3E_STYLERULE_RULE disable;

declare
  TYPE numArray IS TABLE OF NUMBER INDEX BY PLS_INTEGER;
  arrSNO  numArray;
  i       PLS_INTEGER;
begin
  select distinct G3E_SNO
    bulk collect into arrSNO
    from G3E_STYLERULE
    where G3E_RULE in ('Network Protector Symbol', 'Network Protector Symbol - OMS'
                      ,'Network Protector Detail Symbol');
  
  delete from G3E_STYLERULE where G3E_RULE = 'Network Protector Symbol';
  delete from G3E_STYLERULE where G3E_RULE = 'Network Protector Symbol - OMS';

  delete from G3E_STYLERULE where G3E_RULE = 'Network Protector Detail Symbol'; -- obsolete
  
  for i in 1..arrSNO.COUNT loop
    delete from G3E_POINTSTYLE where G3E_SNO = arrSNO(i);
    delete from G3E_STYLE where G3E_SNO = arrSNO(i);
  end loop;
end;
/

alter trigger M_T_AUDR_G3E_STYLERULE_RULE enable;
alter trigger M_T_AUD_G3E_STYLERULE_RULE enable;

-- Point styles

insert into G3E_POINTSTYLE(G3E_SNO,G3E_USERNAME,G3E_FONTNAME,G3E_SYMBOL,G3E_COLOR,G3E_SIZE,G3E_ALIGNMENT,G3E_ROTATION,G3E_USEMASK,G3E_MASKSYMBOL,G3E_PLOTREDLINE,G3E_STYLEUNITS) values (157101,'Network Protector Detail Symbol - SCADA PPI','AEGIS Device',CHR(51),10158079,12,0,0,0,null,0,1);
insert into G3E_POINTSTYLE(G3E_SNO,G3E_USERNAME,G3E_FONTNAME,G3E_SYMBOL,G3E_COLOR,G3E_SIZE,G3E_ALIGNMENT,G3E_ROTATION,G3E_USEMASK,G3E_MASKSYMBOL,G3E_PLOTREDLINE,G3E_STYLEUNITS) values (157102,'Network Protector Detail Symbol - SCADA PPR','AEGIS Device',CHR(51),14540253,12,0,0,0,null,0,1);
insert into G3E_POINTSTYLE(G3E_SNO,G3E_USERNAME,G3E_FONTNAME,G3E_SYMBOL,G3E_COLOR,G3E_SIZE,G3E_ALIGNMENT,G3E_ROTATION,G3E_USEMASK,G3E_MASKSYMBOL,G3E_PLOTREDLINE,G3E_STYLEUNITS) values (157103,'Network Protector Detail Symbol - SCADA OSR','AEGIS Device',CHR(51),5921370,12,0,0,0,null,0,1);
insert into G3E_POINTSTYLE(G3E_SNO,G3E_USERNAME,G3E_FONTNAME,G3E_SYMBOL,G3E_COLOR,G3E_SIZE,G3E_ALIGNMENT,G3E_ROTATION,G3E_USEMASK,G3E_MASKSYMBOL,G3E_PLOTREDLINE,G3E_STYLEUNITS) values (157104,'Network Protector Detail Symbol - SCADA Open','AEGIS Device',CHR(51),65280,12,0,0,0,null,0,1);
insert into G3E_POINTSTYLE(G3E_SNO,G3E_USERNAME,G3E_FONTNAME,G3E_SYMBOL,G3E_COLOR,G3E_SIZE,G3E_ALIGNMENT,G3E_ROTATION,G3E_USEMASK,G3E_MASKSYMBOL,G3E_PLOTREDLINE,G3E_STYLEUNITS) values (157105,'Network Protector Detail Symbol - SCADA Closed','AEGIS Device',CHR(51),24319,12,0,0,0,null,0,1);
insert into G3E_POINTSTYLE(G3E_SNO,G3E_USERNAME,G3E_FONTNAME,G3E_SYMBOL,G3E_COLOR,G3E_SIZE,G3E_ALIGNMENT,G3E_ROTATION,G3E_USEMASK,G3E_MASKSYMBOL,G3E_PLOTREDLINE,G3E_STYLEUNITS) values (157106,'Network Protector Detail Symbol - SCADA default','AEGIS Device',CHR(51),65535,12,0,0,0,null,0,1);
insert into G3E_POINTSTYLE(G3E_SNO,G3E_USERNAME,G3E_FONTNAME,G3E_SYMBOL,G3E_COLOR,G3E_SIZE,G3E_ALIGNMENT,G3E_ROTATION,G3E_USEMASK,G3E_MASKSYMBOL,G3E_PLOTREDLINE,G3E_STYLEUNITS) values (157107,'Network Protector Detail Symbol - PPI','AEGIS Device',CHR(50),10158079,12,0,0,0,null,0,1);
insert into G3E_POINTSTYLE(G3E_SNO,G3E_USERNAME,G3E_FONTNAME,G3E_SYMBOL,G3E_COLOR,G3E_SIZE,G3E_ALIGNMENT,G3E_ROTATION,G3E_USEMASK,G3E_MASKSYMBOL,G3E_PLOTREDLINE,G3E_STYLEUNITS) values (157108,'Network Protector Detail Symbol - PPR','AEGIS Device',CHR(50),14540253,12,0,0,0,null,0,1);
insert into G3E_POINTSTYLE(G3E_SNO,G3E_USERNAME,G3E_FONTNAME,G3E_SYMBOL,G3E_COLOR,G3E_SIZE,G3E_ALIGNMENT,G3E_ROTATION,G3E_USEMASK,G3E_MASKSYMBOL,G3E_PLOTREDLINE,G3E_STYLEUNITS) values (157109,'Network Protector Detail Symbol - OSR','AEGIS Device',CHR(50),5921370,12,0,0,0,null,0,1);
insert into G3E_POINTSTYLE(G3E_SNO,G3E_USERNAME,G3E_FONTNAME,G3E_SYMBOL,G3E_COLOR,G3E_SIZE,G3E_ALIGNMENT,G3E_ROTATION,G3E_USEMASK,G3E_MASKSYMBOL,G3E_PLOTREDLINE,G3E_STYLEUNITS) values (157110,'Network Protector Detail Symbol - Open','AEGIS Device',CHR(50),65280,12,0,0,0,null,0,1);
insert into G3E_POINTSTYLE(G3E_SNO,G3E_USERNAME,G3E_FONTNAME,G3E_SYMBOL,G3E_COLOR,G3E_SIZE,G3E_ALIGNMENT,G3E_ROTATION,G3E_USEMASK,G3E_MASKSYMBOL,G3E_PLOTREDLINE,G3E_STYLEUNITS) values (157111,'Network Protector Detail Symbol - Closed','AEGIS Device',CHR(50),24319,12,0,0,0,null,0,1);
insert into G3E_POINTSTYLE(G3E_SNO,G3E_USERNAME,G3E_FONTNAME,G3E_SYMBOL,G3E_COLOR,G3E_SIZE,G3E_ALIGNMENT,G3E_ROTATION,G3E_USEMASK,G3E_MASKSYMBOL,G3E_PLOTREDLINE,G3E_STYLEUNITS) values (157112,'Network Protector Detail Symbol - default','AEGIS Device',CHR(50),65535,12,0,0,0,null,0,1);


-- Style rules - GIS

insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15710101,157101,'Network Protector Symbol','CAPABLE_YN=''Y'' and FEATURE_STATE_C in (''PPI'',''ABI'')',1,157101,'Network Protector Detail Symbol - SCADA PPI');
insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15710102,157101,'Network Protector Symbol','CAPABLE_YN=''Y'' and FEATURE_STATE_C in (''PPR'',''ABR'',''PPA'',''ABA'')',2,157102,'Network Protector Detail Symbol - SCADA PPR');
insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15710103,157101,'Network Protector Symbol','CAPABLE_YN=''Y'' and FEATURE_STATE_C in (''OSR'',''OSA'')',3,157103,'Network Protector Detail Symbol - SCADA OSR');
insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15710104,157101,'Network Protector Symbol','CAPABLE_YN=''Y'' and STATUS_NORMAL_C=''OPEN''',4,157104,'Network Protector Detail Symbol - SCADA Open');
insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15710105,157101,'Network Protector Symbol','CAPABLE_YN=''Y'' and STATUS_NORMAL_C=''CLOSED''',5,157105,'Network Protector Detail Symbol - SCADA Closed');
insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15710106,157101,'Network Protector Symbol','CAPABLE_YN=''Y''',6,157106,'Network Protector Detail Symbol - SCADA default');
insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15710107,157101,'Network Protector Symbol','FEATURE_STATE_C in (''PPI'',''ABI'')',7,157107,'Network Protector Detail Symbol - PPI');
insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15710108,157101,'Network Protector Symbol','FEATURE_STATE_C in (''PPR'',''ABR'',''PPA'',''ABA'')',8,157108,'Network Protector Detail Symbol - PPR');
insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15710109,157101,'Network Protector Symbol','FEATURE_STATE_C in (''OSR'',''OSA'')',9,157109,'Network Protector Detail Symbol - OSR');
insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15710110,157101,'Network Protector Symbol','STATUS_NORMAL_C=''OPEN''',10,157110,'Network Protector Detail Symbol - Open');
insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15710111,157101,'Network Protector Symbol','STATUS_NORMAL_C=''CLOSED''',11,157111,'Network Protector Detail Symbol - Closed');
insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15710199,157101,'Network Protector Symbol','',99,157112,'Network Protector Detail Symbol - default');


-- Style rules - OMS

insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15720101,157201,'Network Protector Symbol - OMS','CAPABLE_YN=''Y'' and FEATURE_STATE_C in (''PPI'',''ABI'')',1,157101,'Network Protector Detail Symbol - SCADA PPI');
insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15720102,157201,'Network Protector Symbol - OMS','CAPABLE_YN=''Y'' and FEATURE_STATE_C in (''PPR'',''ABR'',''PPA'',''ABA'')',2,157102,'Network Protector Detail Symbol - SCADA PPR');
insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15720103,157201,'Network Protector Symbol - OMS','CAPABLE_YN=''Y'' and FEATURE_STATE_C in (''OSR'',''OSA'')',3,157103,'Network Protector Detail Symbol - SCADA OSR');
insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15720104,157201,'Network Protector Symbol - OMS','CAPABLE_YN=''Y'' and STATUS_NORMAL_C=''OPEN''',4,157104,'Network Protector Detail Symbol - SCADA Open');
insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15720105,157201,'Network Protector Symbol - OMS','CAPABLE_YN=''Y'' and STATUS_NORMAL_C=''CLOSED''',5,157105,'Network Protector Detail Symbol - SCADA Closed');
insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15720106,157201,'Network Protector Symbol - OMS','CAPABLE_YN=''Y''',6,157106,'Network Protector Detail Symbol - SCADA default');
insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15720107,157201,'Network Protector Symbol - OMS','FEATURE_STATE_C in (''PPI'',''ABI'')',7,157107,'Network Protector Detail Symbol - PPI');
insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15720108,157201,'Network Protector Symbol - OMS','FEATURE_STATE_C in (''PPR'',''ABR'',''PPA'',''ABA'')',8,157108,'Network Protector Detail Symbol - PPR');
insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15720109,157201,'Network Protector Symbol - OMS','FEATURE_STATE_C in (''OSR'',''OSA'')',9,157109,'Network Protector Detail Symbol - OSR');
insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15720110,157201,'Network Protector Symbol - OMS','STATUS_NORMAL_C=''OPEN''',10,157110,'Network Protector Detail Symbol - Open');
insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15720111,157201,'Network Protector Symbol - OMS','STATUS_NORMAL_C=''CLOSED''',11,157111,'Network Protector Detail Symbol - Closed');
insert into G3E_STYLERULE(G3E_SRROWNO,G3E_SRNO,G3E_RULE,G3E_FILTER,G3E_FILTERORDINAL,G3E_SNO,G3E_DESCRIPTION) values (15720199,157201,'Network Protector Symbol - OMS','',99,157112,'Network Protector Detail Symbol - default');


spool off;
