
set echo on
set linesize 1000
set pagesize 300
set trimspool on

exec adm_support.set_start(2688, 'ONCOR_JIRA1848-Vault_Add_Attributes');
spool c:\temp\2688-20180713-ONCOR_JIRA1848-Vault_Add_Attributes.log
--**************************************************************************************
--SCRIPT NAME: 2688-20180713-ONCOR_JIRA1848-Vault_Add_Attributes.sql
--**************************************************************************************
-- AUTHOR				: INGRNET\PVKURELL
-- DATE					: 13-JUL-2018
-- CYCLE				: 00.03.07
-- JIRA NUMBER			: 1848
-- PRODUCT VERSION		: 10.3
-- PRJ IDENTIFIER		: G/TECHNOLOGY - ONCOR
-- PROGRAM DESC			: Add attributes to Vault Attribute component
-- SOURCE DATABASE	:
--**************************************************************************************
-- Script Body
--**************************************************************************************


---**Create Network Number Value list****
CREATE TABLE VL_NETWORK_NBR
(
	VL_KEY    	VARCHAR2(10) NOT NULL, 
	VL_VALUE    VARCHAR2(30) ,
	UNUSED      NUMBER(1),    
	ORDINAL     NUMBER(10)  
);

Insert into G3E_PICKLIST (G3E_PNO,G3E_USERNAME,G3E_TABLE,G3E_KEYFIELD,G3E_VALUEFIELD,G3E_VALIDATION,G3E_PUBLISH) values (381,'Network Number','VL_NETWORK_NBR','VL_KEY','VL_VALUE','G3ERestricted',0);

---***Add columns to Network Protector component table***

Alter Table B$VAULT_N Add VAULT_ID_OBSOLETE	VARCHAR2(10);
Alter Table B$VAULT_N Add BUILDING_NM	VARCHAR2(50);
Alter Table B$VAULT_N Add ADDRESS	VARCHAR2(50);
Alter Table B$VAULT_N Add VAULT_NBR	VARCHAR2(10);
Alter Table B$VAULT_N Add ROOM_LTR	VARCHAR2(1);
Alter Table B$VAULT_N Add NETWORK_NBR	VARCHAR2(4);


execute CREATE_VIEWS.CREATE_LTT_VIEW('B$VAULT_N');
execute CREATE_TRIGGERS.CREATE_LTT_TRIGGER('B$VAULT_N');

---***Add columns to Vault Attribute Component ****

insert into G3E_ATTRIBUTE(G3E_ANO,G3E_CNO,G3E_VNO,G3E_FIELD,G3E_USERNAME,G3E_FORMAT,G3E_REQUIRED,G3E_TOOLTIP,G3E_HYPERTEXT,G3E_PNO,G3E_COPY,G3E_EXCLUDEFROMEDIT,G3E_DATATYPE,G3E_EXCLUDEFROMREPLACE,G3E_BREAKCOPY,G3E_COPYATTRIBUTE,G3E_WRAPTEXT,G3E_FUNCTIONALVALIDATION,G3E_UNIQUE,G3E_EDITDATE)  Values(1170111,11701,NULL,'VAULT_ID_OBSOLETE','Obsolete Vault ID','',0,'Obsolete Vault ID',0,NULL,0,0,10,0,0,0,1,1,0,sysdate);
insert into G3E_ATTRIBUTE(G3E_ANO,G3E_CNO,G3E_VNO,G3E_FIELD,G3E_USERNAME,G3E_FORMAT,G3E_REQUIRED,G3E_TOOLTIP,G3E_HYPERTEXT,G3E_PNO,G3E_COPY,G3E_EXCLUDEFROMEDIT,G3E_DATATYPE,G3E_EXCLUDEFROMREPLACE,G3E_BREAKCOPY,G3E_COPYATTRIBUTE,G3E_WRAPTEXT,G3E_FUNCTIONALVALIDATION,G3E_UNIQUE,G3E_EDITDATE)  Values(1170112,11701,NULL,'BUILDING_NM','Building Name','',0,'Building Name',0,NULL,0,0,10,0,0,0,1,1,0,sysdate);
insert into G3E_ATTRIBUTE(G3E_ANO,G3E_CNO,G3E_VNO,G3E_FIELD,G3E_USERNAME,G3E_FORMAT,G3E_REQUIRED,G3E_TOOLTIP,G3E_HYPERTEXT,G3E_PNO,G3E_COPY,G3E_EXCLUDEFROMEDIT,G3E_DATATYPE,G3E_EXCLUDEFROMREPLACE,G3E_BREAKCOPY,G3E_COPYATTRIBUTE,G3E_WRAPTEXT,G3E_FUNCTIONALVALIDATION,G3E_UNIQUE,G3E_EDITDATE)  Values(1170113,11701,NULL,'ADDRESS','Address','',0,'Address',0,NULL,0,0,10,0,0,0,1,1,0,sysdate);
insert into G3E_ATTRIBUTE(G3E_ANO,G3E_CNO,G3E_VNO,G3E_FIELD,G3E_USERNAME,G3E_FORMAT,G3E_REQUIRED,G3E_TOOLTIP,G3E_HYPERTEXT,G3E_PNO,G3E_COPY,G3E_EXCLUDEFROMEDIT,G3E_DATATYPE,G3E_EXCLUDEFROMREPLACE,G3E_BREAKCOPY,G3E_COPYATTRIBUTE,G3E_WRAPTEXT,G3E_FUNCTIONALVALIDATION,G3E_UNIQUE,G3E_EDITDATE)  Values(1170114,11701,NULL,'VAULT_NBR','Vault Number','',0,'Vault Number',0,NULL,0,0,10,0,0,0,1,1,0,sysdate);
insert into G3E_ATTRIBUTE(G3E_ANO,G3E_CNO,G3E_VNO,G3E_FIELD,G3E_USERNAME,G3E_FORMAT,G3E_REQUIRED,G3E_TOOLTIP,G3E_HYPERTEXT,G3E_PNO,G3E_COPY,G3E_EXCLUDEFROMEDIT,G3E_DATATYPE,G3E_EXCLUDEFROMREPLACE,G3E_BREAKCOPY,G3E_COPYATTRIBUTE,G3E_WRAPTEXT,G3E_FUNCTIONALVALIDATION,G3E_UNIQUE,G3E_EDITDATE)  Values(1170115,11701,NULL,'ROOM_LTR','Room Letter','',0,'Room Letter',0,NULL,0,0,10,0,0,0,1,1,0,sysdate);
insert into G3E_ATTRIBUTE(G3E_ANO,G3E_CNO,G3E_VNO,G3E_FIELD,G3E_USERNAME,G3E_FORMAT,G3E_REQUIRED,G3E_TOOLTIP,G3E_HYPERTEXT,G3E_PNO,G3E_COPY,G3E_EXCLUDEFROMEDIT,G3E_DATATYPE,G3E_EXCLUDEFROMREPLACE,G3E_BREAKCOPY,G3E_COPYATTRIBUTE,G3E_WRAPTEXT,G3E_FUNCTIONALVALIDATION,G3E_UNIQUE,G3E_EDITDATE)  Values(1170116,11701,NULL,'NETWORK_NBR','Network','',0,'Network',0,381,0,0,10,0,0,0,1,1,0,sysdate);


---***Add attributes to Vault attribute Dialog tab****

Insert into G3E_TABATTRIBUTE (G3E_TANO,G3E_ANO,G3E_ORDINAL,G3E_READONLY,G3E_DTNO,G3E_PNO) VALUES(11730111,1170114,12,0,117301,NULL);
Insert into G3E_TABATTRIBUTE (G3E_TANO,G3E_ANO,G3E_ORDINAL,G3E_READONLY,G3E_DTNO,G3E_PNO) VALUES(11730112,1170115,14,0,117301,NULL);
Insert into G3E_TABATTRIBUTE (G3E_TANO,G3E_ANO,G3E_ORDINAL,G3E_READONLY,G3E_DTNO,G3E_PNO) VALUES(11730113,1170116,75,0,117301,381);
Insert into G3E_TABATTRIBUTE (G3E_TANO,G3E_ANO,G3E_ORDINAL,G3E_READONLY,G3E_DTNO,G3E_PNO) VALUES(11730114,1170112,120,0,117301,NULL);
Insert into G3E_TABATTRIBUTE (G3E_TANO,G3E_ANO,G3E_ORDINAL,G3E_READONLY,G3E_DTNO,G3E_PNO) VALUES(11730115,1170113,130,0,117301,NULL);
Insert into G3E_TABATTRIBUTE (G3E_TANO,G3E_ANO,G3E_ORDINAL,G3E_READONLY,G3E_DTNO,G3E_PNO) VALUES(11730116,1170111,140,0,117301,NULL);

Insert into G3E_TABATTRIBUTE (G3E_TANO,G3E_ANO,G3E_ORDINAL,G3E_READONLY,G3E_DTNO,G3E_PNO) VALUES(11720111,1170114,12,0,117201,NULL);
Insert into G3E_TABATTRIBUTE (G3E_TANO,G3E_ANO,G3E_ORDINAL,G3E_READONLY,G3E_DTNO,G3E_PNO) VALUES(11720112,1170115,14,0,117201,NULL);
Insert into G3E_TABATTRIBUTE (G3E_TANO,G3E_ANO,G3E_ORDINAL,G3E_READONLY,G3E_DTNO,G3E_PNO) VALUES(11720113,1170116,75,0,117201,381);
Insert into G3E_TABATTRIBUTE (G3E_TANO,G3E_ANO,G3E_ORDINAL,G3E_READONLY,G3E_DTNO,G3E_PNO) VALUES(11720114,1170112,120,0,117201,NULL);
Insert into G3E_TABATTRIBUTE (G3E_TANO,G3E_ANO,G3E_ORDINAL,G3E_READONLY,G3E_DTNO,G3E_PNO) VALUES(11720115,1170113,130,0,117201,NULL);
Insert into G3E_TABATTRIBUTE (G3E_TANO,G3E_ANO,G3E_ORDINAL,G3E_READONLY,G3E_DTNO,G3E_PNO) VALUES(11720116,1170111,140,0,117201,NULL);

Insert into G3E_TABATTRIBUTE (G3E_TANO,G3E_ANO,G3E_ORDINAL,G3E_READONLY,G3E_DTNO,G3E_PNO) VALUES(11710111,1170114,12,1,117101,NULL);
Insert into G3E_TABATTRIBUTE (G3E_TANO,G3E_ANO,G3E_ORDINAL,G3E_READONLY,G3E_DTNO,G3E_PNO) VALUES(11710112,1170115,14,1,117101,NULL);
Insert into G3E_TABATTRIBUTE (G3E_TANO,G3E_ANO,G3E_ORDINAL,G3E_READONLY,G3E_DTNO,G3E_PNO) VALUES(11710113,1170116,75,1,117101,381);
Insert into G3E_TABATTRIBUTE (G3E_TANO,G3E_ANO,G3E_ORDINAL,G3E_READONLY,G3E_DTNO,G3E_PNO) VALUES(11710114,1170112,120,1,117101,NULL);
Insert into G3E_TABATTRIBUTE (G3E_TANO,G3E_ANO,G3E_ORDINAL,G3E_READONLY,G3E_DTNO,G3E_PNO) VALUES(11710115,1170113,130,1,117101,NULL);
Insert into G3E_TABATTRIBUTE (G3E_TANO,G3E_ANO,G3E_ORDINAL,G3E_READONLY,G3E_DTNO,G3E_PNO) VALUES(11710116,1170111,140,1,117101,NULL);

COMMIT;

---***Create public synonym on picklist and grant privileges***

Create public SYNONYM VL_NETWORK_NBR for VL_NETWORK_NBR;
Grant Select on VL_NETWORK_NBR to DESIGNER,FINANCE,MARKETING;
Grant Select,Insert,Update,Delete on VL_NETWORK_NBR to SUPERVISOR,ADMINISTRATOR;


---***Execute Packages****
execute MG3ElanguageSubTableUtils.SynchronizeSubTables;
execute MG3EOTCreateOptimizedTables;
execute MG3ECreateOptableViews;

execute GDOTRIGGERS.CREATE_GDOTRIGGERS; 
execute G3E_DynamicProcedures.Generate;

--**************************************************************************************
-- End Script Body
--**************************************************************************************
spool off;
exec adm_support.set_finish(2688);


